{% extends 'base.html' %}

{% block content %}
<h2>Your Performance Overview</h2>

<table border="1">
  <tr>
    <th>Score</th>
    <th>Grade</th>
    <th>Date</th>
  </tr>
  {% for p in performances %}
  <tr>
    <td>{{ p.score }}</td>
    <td>{{ p.grade }}</td>
    <td>{{ p.created_at.strftime('%Y-%m-%d') }}</td>
  </tr>
  {% endfor %}
</table>

<!-- Chart.js Canvas -->
<canvas id="performanceChart" width="400" height="200"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Prepare the labels and data arrays
  const labels = {{ performances | map(attribute='created_at.strftime("%Y-%m-%d")') | list }};
  const scores = {{ performances | map(attribute='score') | list }};

  // Chart.js Data Configuration
  const data = {
    labels: labels,
    datasets: [{
      label: 'Performance Over Time',
      data: scores,
      backgroundColor: 'rgba(54, 162, 235, 0.2)',
      borderColor: 'rgb(54, 162, 235)',
      borderWidth: 2
    }]
  };

  // Chart Configuration
  const config = {
    type: 'line', // You can also change this to 'bar' or 'radar'
    data: data,
  };

  // Render the chart in the canvas element
  new Chart(document.getElementById('performanceChart'), config);
</script>

{% endblock %}
